PROGRAM PROJECT1
IMPLICIT NONE
INTEGER::N,I
REAL,DIMENSION(:),ALLOCATABLE::X,Y
REAL::K
!배열읽기
READ*,N
ALLOCATE(X(N),Y(N))
DO I=1,N
READ*,X(I),Y(I)
END DO


!배열 잘 읽는지 확인
DO I=1,N
PRINT *, X(I), Y(I)
END DO


READ*,K
DO I=1,N
PRINT *, LNF(I,K)
END DO


!직선의?방정식?
CONTAINS
FUNCTION LNF(I,P) RESULT(L)
IMPLICIT NONE
INTEGER::I
REAL::L,P
IF (I<N)THEN
L=((Y(I+1)-Y(I))/(X(I+1)-X(I)))*(P-X(I))+Y(I)
ELSE
L=((Y(1)-Y(I))/(X(1)-X(I)))*(P-X(I))+Y(I)
END IF
END FUNCTION LNF
END PROGRAM
